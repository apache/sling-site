<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Sling API CRUD Support</title>
        <link rel="icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <script src='https://www.apachecon.com/event-images/snippet.js'></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
	<!-- Matomo Web Analytics -->
	<script>
	var _paq = window._paq = window._paq || [];
	/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
	/* We explicitly disable cookie tracking to avoid privacy issues */
	_paq.push(['disableCookies']); 
	_paq.push(['trackPageView']);
	_paq.push(['enableLinkTracking']);
	(function() {
	  var u="https://matomo.privacy.apache.org/";
	  _paq.push(['setTrackerUrl', u+'matomo.php']);
	  _paq.push(['setSiteId', '6']);
	  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
	  g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
	})();
	</script>
	<!-- End Matomo Code -->
	<link href='/pagefind/pagefind-ui.css' rel='stylesheet'><script src='/pagefind/pagefind-ui.js' type='text/javascript'></script>
	<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#searchbox" });
    });
	</script>
	
    </head>    <body>
        <div class="section">
            <div class="level is-marginless">
<div class="logo">
                    <a href="https://sling.apache.org">
                        <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                    </a>
                </div><div class="header">
                    <a href="https://www.apache.org">
                        <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                    </a>
                </div>                
            </div><section class="searchbox level is-marginless">
                <div id="searchbox"></div>
            </section><div class="columns is-gapless">
                <div class="column is-narrow sidemenu">
<div class="container">
                        <nav class="menu">
                            <ul class="menu-list box is-shadowless is-marginless">
                                <li>
                                    <p class="menu-label">
                                        <strong>Documentation</strong>
                                    </p><ul>
                                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>API Docs</strong>
                                    </p><ul>
                                        <li><a href="/apidocs/sling12/index.html">Sling 12</a></li><li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Support</strong>
                                    </p><ul>
                                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Sitemap</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Project Info</strong>
                                    </p><ul>
                                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Source</strong>
                                    </p><ul>
                                        <li><a href="/repolist.html">Repositories</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Apache Software<br>Foundation</strong>
                                    </p><ul>
                                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li>
                                    </ul>
                                </li><li>
                                    <a class="acevent" data-format="square" data-event="random"></a>
                                </li><li>
                                    <a href="https://apache.org/foundation/contributing.html" class="column">
                                        <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>                    
                </div><div class="column main">
                    <div class="box is-shadowless is-marginless">
                        <div class="level">
                            <div class="pagenav">
<div class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="/">
                                                Home
                                            </a>
                                        </li><li>
                                            <a href="/documentation.html">
                                                Documentation
                                            </a>
                                        </li><li>
                                            <a href="/documentation/the-sling-engine.html">
                                                The Sling Engine
                                            </a>
                                        </li>
                                    </ul>
                                </div>                                
                            </div><div class="tags">
                                <span class="tag">
                                    <a href="/tags/api.html">
                                        api
                                    </a>
                                </span><span class="tag">
                                    <a href="/tags/core.html">
                                        core
                                    </a>
                                </span>
                            </div>
                        </div><h1 class="title">
                            Sling API CRUD Support
                        </h1><nav class="menu">
                            <ul class="menu-list box is-shadowless is-paddingless">
                                <li id="generatedToC">
                                    <p class="menu-label">
                                        <strong>Table of Contents</strong>
                                    </p>
                                </li>
                            </ul>
                        </nav><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=title],h2,h3','ulClass':'menu-list'}); } );</script><div class="content is-marginless">
<div class="row" data-pagefind-body="true"><div><section><p><!-- TODO reactivate TOC once JBake moves to flexmark-java -->
</p>
<h1><a href="#apache-sling-api-support" id="apache-sling-api-support">Apache Sling API Support</a></h1>
<p>As of version 2.3.0, the Sling API provides full Create Read Update Delete (CRUD) features.  CRUD support is provided by the addition of the following methods to the ResourceResolver:</p>
<ul>
<li><a href="https://sling.apache.org/apidocs/sling11/org/apache/sling/api/resource/ResourceResolver.html#delete-org.apache.sling.api.resource.Resource-"><code>void delete(Resource resource) throws PersistenceException</code></a></li>
<li><a href="https://sling.apache.org/apidocs/sling11/org/apache/sling/api/resource/ResourceResolver.html#create-org.apache.sling.api.resource.Resource-java.lang.String-java.util.Map-"><code>Resource create(Resource parent, String name, Map&lt;String, Object&gt; properties) throws PersistenceException</code></a></li>
<li><a href="https://sling.apache.org/apidocs/sling11/org/apache/sling/api/resource/ResourceResolver.html#revert--"><code>void revert()</code></a></li>
<li><a href="https://sling.apache.org/apidocs/sling11/org/apache/sling/api/resource/ResourceResolver.html#commit--"><code>void commit() throws PersistenceException</code></a></li>
<li><a href="https://sling.apache.org/apidocs/sling7/org/apache/sling/api/resource/ResourceResolver.html#hasChanges--"><code>boolean hasChanges()</code></a></li>
<li><a href="https://sling.apache.org/apidocs/sling11/org/apache/sling/api/resource/ResourceResolver.html#refresh--"><code>void refresh()</code></a></li>
<li><code>orderBefore(Resource parent, String name, String followingSiblingName) throws UnsupportedOperationException, PersistenceException, IllegalArgumentException</code> (since <a href="https://issues.apache.org/jira/browse/SLING-7975">API 2.24.0</a>)</li>
</ul>
<p>Those methods provide the ability to create and delete resources as well. In addition you can adapt a <code>Resource</code> to a <code>ModifiableValueMap</code> interface which is similar to the <code>ValueMap</code> interface, but allows for updating properties on a resource.</p>
<h1><a href="#examples" id="examples">Examples</a></h1>
<p>Here are some examples of common operations performed using the Sling Post Servlet and Sling API CRUD support.  Note, the examples are derived from the cheat sheet in Adobe's AEM documentation at <a href="https://experienceleague.adobe.com/docs/experience-manager-cloud-service/implementing/developing/full-stack/sling-cheatsheet.html">https://experienceleague.adobe.com/docs/experience-manager-cloud-service/implementing/developing/full-stack/sling-cheatsheet.html</a>.</p>
<h2><a href="#updating-a-property" id="updating-a-property">Updating a Property</a></h2>
<p>Update <code>/myresource</code>, setting the title and body:</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;title&quot;&gt;
  &lt;textarea name=&quot;body&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
ModifiableValueMap properties = myResource.adaptTo(ModifiableValueMap.class);
properties.put(&quot;title&quot;, {TITLE});
properties.put(&quot;body&quot;, {BODY});
resourceResolver.commit();
</code></pre>
<h2><a href="#create-new-resource" id="create-new-resource">Create New Resource</a></h2>
<p>Create a new resource below <code>/myresource</code></p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource/&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;dummy&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
Map&lt;String,Object&gt; properties = new HashMap&lt;String,Object&gt;();
properties.put(&quot;jcr:primaryType&quot;, &quot;nt:unstructured&quot;);
properties.put(&quot;sling:resourceType&quot;, &quot;myapp/components/mytype&quot;);
Resource dummy = resourceResolver.create(myResource, &quot;dummy&quot;, properties);
resourceResolver.commit();
</code></pre>
<h2><a href="#remove-a-property" id="remove-a-property">Remove a Property</a></h2>
<p>Remove the property title</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;title@Delete&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
ModifiableValueMap properties = myResource.adaptTo(ModifiableValueMap.class);
properties.remove(&quot;title&quot;);
resourceResolver.commit();
</code></pre>
<h2><a href="#copy-a-resource" id="copy-a-resource">Copy a Resource</a></h2>
<p>Copy the resource <code>/myresource</code> to <code>/myresource2</code></p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:operation&quot; value=&quot;copy&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:dest&quot; value=&quot;/myresource2&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:replace&quot; value=&quot;true&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Map&lt;String,Object&gt; properties = myResource.adaptTo(ValueMap.class);
Resource myResource2 = resourceResolver.create(null, &quot;myresource2&quot;, properties);
resourceResolver.commit();
</code></pre>
<h2><a href="#move-a-resource" id="move-a-resource">Move a Resource</a></h2>
<p>Move the resource <code>/myresource2</code> to <code>/myresource3</code></p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource2&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:operation&quot; value=&quot;move&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:dest&quot; value=&quot;/myresource3&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource2 = resourceResolver.getResource(&quot;/myresource2&quot;);
Map&lt;String,Object&gt; properties = myResource2.adaptTo(ValueMap.class);
Resource myResource3 = resourceResolver.create(null, &quot;myresource3&quot;, properties);
resourceResolver.delete(myResource2);
resourceResolver.commit();
</code></pre>
<h2><a href="#setting-non-string-value" id="setting-non-string-value">Setting non-String Value</a></h2>
<p>Set the property date to a particular date</p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource3&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;date&quot; value=&quot;2008-06-13T18:55:00&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;date@TypeHint&quot; value=&quot;Date&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource3 = resourceResolver.getResource(&quot;/myresource3&quot;);
Calendar calendar = [SOME_DATE];
ModifiableValueMap properties = myResource3.adaptTo(ModifiableValueMap.class);
properties.put(&quot;date&quot;, calendar);
resourceResolver.commit();
</code></pre>
<h2><a href="#delete-a-resource" id="delete-a-resource">Delete a Resource</a></h2>
<p>Delete the resource <code>/myresource</code></p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:operation&quot; value=&quot;delete&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource myResource = resourceResolver.getResource(&quot;/myresource&quot;);
resourceResolver.delete(myResource);
resourceResolver.commit();
</code></pre>
<h2><a href="#order-a-resource" id="order-a-resource">Order a Resource</a></h2>
<p>Reorder the resource <code>/myresource</code> before sibling node <code>child1</code></p>
<p><strong>Sling Post Servlet</strong></p>
<pre><code>&lt;form action=&quot;/myresource&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;:order&quot; value=&quot;before child1&quot;&gt;
&lt;/form&gt;
</code></pre>
<p><strong>Sling API CRUD</strong></p>
<pre><code>Resource parentResource = resourceResolver.getResource(&quot;/&quot;);
resourceResolver.orderBefore(parentResource, &quot;myresource&quot;, &quot;child1&quot;);
resourceResolver.commit();
</code></pre>
<h1><a href="#value-class-support" id="value-class-support">Value Class Support</a></h1>
<div class="info">
	Please note, this information is specific to the Sling JCR Resource implementation provided by the Apache Sling project.  Other implementations may have different value class support.  
</div>
<p>The classes implementing the following types are supported directly when setting properties:</p>
<ul>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/util/Calendar.html">Calendar</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/io/InputStream.html">InputStream</a></li>
<li><a href="https://s.apache.org/jcr-2.0-javadoc/javax/jcr/Node.html">Node</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/math/BigDecimal.html">BigDecimal</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Long.html">Long</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Short.html">Short</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Integer.html">Integer</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Number.html">Number</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/Boolean.html">Boolean</a></li>
<li><a href="http://docs.oracle.com/javase/8/docs/api/java/lang/String.html">String</a></li>
</ul>
<p>As well as the corresponding primitive types.  Any object which implements the Serializable interface will be serialized and the result of the serialization will be saved as a binary value for the property.</p>
</section></div></div><div data-pagefind-body="true" data-pagefind-weight="7.0" style="display:none;"> - ( Sling API CRUD Support )</div>                            
                        </div>
                    </div>
                </div>
            </div><footer class="footer">
                <div class="content has-text-centered is-small">
<div class="editpagelink">
                        This page can be edited on GitHub at <a href="https://github.com/apache/sling-site/edit/master/src/main/jbake/content/documentation/the-sling-engine/sling-api-crud-support.md">
                            content/documentation/the-sling-engine/sling-api-crud-support.md
                        </a>
                    </div>                    <div class="revisionInfo">
                        Last modified by <span class="author">Konrad Windszus</span> on <span class="comment">2021-11-23</span>
                    </div><p>
                        Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project
    logo are trademarks of The Apache Software Foundation. All other marks mentioned 
    may be trademarks or registered trademarks of their respective owners.
                    </p><p>
                        Copyright Â© 2007-2023<a href="https://www.apache.org/">
                            The Apache Software Foundation
                        </a>|<a href="https://privacy.apache.org/policies/privacy-policy-public.html">
                            Privacy Policy
                        </a>
                    </p>
                </div>
            </footer>
        </div>
    </body>
</html>