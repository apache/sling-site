<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Commons Crypto</title>
        <link rel="icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <script src='https://www.apachecon.com/event-images/snippet.js'></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
	<!-- Matomo Web Analytics -->
	<script>
	var _paq = window._paq = window._paq || [];
	/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
	/* We explicitly disable cookie tracking to avoid privacy issues */
	_paq.push(['disableCookies']); 
	_paq.push(['trackPageView']);
	_paq.push(['enableLinkTracking']);
	(function() {
	  var u="https://matomo.privacy.apache.org/";
	  _paq.push(['setTrackerUrl', u+'matomo.php']);
	  _paq.push(['setSiteId', '6']);
	  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
	  g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
	})();
	</script>
	<!-- End Matomo Code -->
	<link href='/pagefind/pagefind-ui.css' rel='stylesheet'><script src='/pagefind/pagefind-ui.js' type='text/javascript'></script>
	<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#searchbox" });
    });
	</script>
	
    </head>    <body>
        <div class="section">
            <div class="level is-marginless">
<div class="logo">
                    <a href="https://sling.apache.org">
                        <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                    </a>
                </div><div class="header">
                    <a href="https://www.apache.org">
                        <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                    </a>
                </div>                
            </div><section class="searchbox level is-marginless">
                <div id="searchbox"></div>
            </section><div class="columns is-gapless">
                <div class="column is-narrow sidemenu">
<div class="container">
                        <nav class="menu">
                            <ul class="menu-list box is-shadowless is-marginless">
                                <li>
                                    <p class="menu-label">
                                        <strong>Documentation</strong>
                                    </p><ul>
                                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>API Docs</strong>
                                    </p><ul>
                                        <li><a href="/apidocs/sling12/index.html">Sling 12</a></li><li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Support</strong>
                                    </p><ul>
                                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Sitemap</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Project Info</strong>
                                    </p><ul>
                                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Source</strong>
                                    </p><ul>
                                        <li><a href="/repolist.html">Repositories</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Apache Software<br>Foundation</strong>
                                    </p><ul>
                                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li>
                                    </ul>
                                </li><li>
                                    <a class="acevent" data-format="square" data-event="random"></a>
                                </li><li>
                                    <a href="https://apache.org/foundation/contributing.html" class="column">
                                        <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>                    
                </div><div class="column main">
                    <div class="box is-shadowless is-marginless">
                        <div class="level">
                            <div class="pagenav">
<div class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="/">
                                                Home
                                            </a>
                                        </li><li>
                                            <a href="/documentation.html">
                                                Documentation
                                            </a>
                                        </li><li>
                                            <a href="/documentation/bundles.html">
                                                Bundles
                                            </a>
                                        </li>
                                    </ul>
                                </div>                                
                            </div><div class="tags">
                                <span class="tag">
                                    <a href="/tags/commons.html">
                                        commons
                                    </a>
                                </span><span class="tag">
                                    <a href="/tags/crypto.html">
                                        crypto
                                    </a>
                                </span>
                            </div>
                        </div><h1 class="title">
                            Commons Crypto
                        </h1><nav class="menu">
                            <ul class="menu-list box is-shadowless is-paddingless">
                                <li id="generatedToC">
                                    <p class="menu-label">
                                        <strong>Table of Contents</strong>
                                    </p>
                                </li>
                            </ul>
                        </nav><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=title],h2,h3','ulClass':'menu-list'}); } );</script><div class="content is-marginless">
<div class="row" data-pagefind-body="true"><div><section><p><!-- TODO reactivate TOC once JBake moves to flexmark-java -->
</p>
<p><strong><a href="https://github.com/apache/sling-org-apache-sling-commons-crypto">Commons Crypto</a> provides a simple API to encrypt and decrypt messages and an extensible implementation based on <a href="http://www.jasypt.org">Jasypt</a>.</strong></p>
<p>The Jasypt implementation and Web Console plugin are optional.</p>
<h2><a href="#api" id="api">API</a></h2>
<h3><a href="#crypto-service" id="crypto-service">Crypto Service</a></h3>
<p>Encrypt a secret message (e.g. service password) and decrypt the ciphertext. The used crypto method is up to the implementation.</p>
<pre><code><!-- TODO syntax marker (::java) disabled -->public interface CryptoService {

    String encrypt(String message);

    String decrypt(String ciphertext);

}
</code></pre>
<p>Use a reference target to get a particular crypto service, e.g. by <em>names</em> (names should be meaningful e.g. mail or database).</p>
<pre><code><!-- TODO syntax marker (::java) disabled -->@Reference(
    target = &quot;(names=sample)&quot;
)
private volatile CryptoService cryptoService;
</code></pre>
<h3><a href="#password-provider" id="password-provider">Password Provider</a></h3>
<p>Password providers are useful when dealing with password-based encryption (PBE, see also <a href="https://tools.ietf.org/html/rfc2898">RFC 2898</a>).</p>
<pre><code><!-- TODO syntax marker (::java) disabled -->public interface PasswordProvider {

    char[] getPassword();

}
</code></pre>
<h4><a href="#file-password-provider" id="file-password-provider">File Password Provider</a></h4>
<p>The file-based password provider reads the password for encryption/decryption from a given file.</p>
<p><img src="commons-crypto/FilePasswordProvider~sample.png" alt="JasyptStandardPBEStringCryptoService Sample Configuration" style="width: 50%; border: 1px solid silver"></p>
<h2><a href="#jasypt-implementation" id="jasypt-implementation">Jasypt implementation</a></h2>
<p>The Commons Crypto module provides a crypto service implementation based on the <a href="http://www.jasypt.org">Jasypt</a> <code>StandardPBEStringEncryptor</code>.</p>
<p>The <code>JasyptStandardPBEStringCryptoService</code> requires at least a password provider and an initialization vector (IV) generator (<code>IvGenerator</code>) to set up the internal <code>StandardPBEStringEncryptor</code>.</p>
<p><img src="commons-crypto/JasyptStandardPBEStringCryptoService~sample.png" alt="JasyptStandardPBEStringCryptoService Sample Configuration" style="width: 50%; border: 1px solid silver"></p>
<p><img src="commons-crypto/JasyptRandomIvGeneratorRegistrar~sample.png" alt="JasyptRandomIvGeneratorRegistrar Sample Configuration" style="width: 50%; border: 1px solid silver"></p>
<h2><a href="#web-console-plugin" id="web-console-plugin">Web Console Plugin</a></h2>
<p>The plugin (<code>/system/console/sling-commons-crypto-encrypt</code>) allows message encryption with a selected crypto service.</p>
<p><img src="commons-crypto/sling-commons-crypto-encrypt-webconsole-plugin.png" alt="Sling Commons Crypto Encrypt Web Console Plugin" style="width: 50%; border: 1px solid silver"></p>
<h2><a href="#sample-configurations" id="sample-configurations">Sample configurations</a></h2>
<p>A module with (minimal) sample configurations can be found in <a href="https://github.com/apache/sling-samples/tree/master/sling-commons-crypto-configuration">Sling's samples Git repo</a>.</p>
<p><code>org.apache.sling.commons.crypto.internal.FilePasswordProvider~sample.json</code></p>
<pre><code>{
  &quot;jcr:primaryType&quot;: &quot;sling:OsgiConfig&quot;,
  &quot;names&quot;: [&quot;sample&quot;], // names is optional
  &quot;path&quot;: &quot;/var/sling/password&quot;
}
</code></pre>
<p><code>org.apache.sling.commons.crypto.jasypt.internal.JasyptRandomIvGeneratorRegistrar~sample.json</code></p>
<pre><code>{
  &quot;jcr:primaryType&quot;: &quot;sling:OsgiConfig&quot;,
  &quot;algorithm&quot;: &quot;SHA1PRNG&quot;
}
</code></pre>
<p><code>org.apache.sling.commons.crypto.jasypt.internal.JasyptStandardPBEStringCryptoService~sample.json</code></p>
<pre><code>{
  &quot;jcr:primaryType&quot;: &quot;sling:OsgiConfig&quot;,
  &quot;names&quot;: [&quot;sample&quot;], // names is optional
  &quot;algorithm&quot;: &quot;PBEWITHHMACSHA512ANDAES_256&quot;
}
</code></pre>
</section></div></div><div data-pagefind-body="true" data-pagefind-weight="7.0" style="display:none;"> - ( Commons Crypto )</div>                            
                        </div>
                    </div>
                </div>
            </div><footer class="footer">
                <div class="content has-text-centered is-small">
<div class="editpagelink">
                        This page can be edited on GitHub at <a href="https://github.com/apache/sling-site/edit/master/src/main/jbake/content/documentation/bundles/commons-crypto.md">
                            content/documentation/bundles/commons-crypto.md
                        </a>
                    </div>                    <div class="revisionInfo">
                        Last modified by <span class="author">Oliver Lietz</span> on <span class="comment">2019-12-14</span>
                    </div><p>
                        Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project
    logo are trademarks of The Apache Software Foundation. All other marks mentioned 
    may be trademarks or registered trademarks of their respective owners.
                    </p><p>
                        Copyright © 2007-2024<a href="https://www.apache.org/">
                            The Apache Software Foundation
                        </a>|<a href="https://privacy.apache.org/policies/privacy-policy-public.html">
                            Privacy Policy
                        </a>
                    </p>
                </div>
            </footer>
        </div>
    </body>
</html>