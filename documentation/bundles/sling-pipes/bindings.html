<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Sling Pipes Bindings</title>
        <link rel="icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <script src='https://www.apachecon.com/event-images/snippet.js'></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
    </head>    <body>
        <div class="section">
            <div class="level is-marginless">
<div class="logo">
                    <a href="https://sling.apache.org">
                        <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                    </a>
                </div><div class="header">
                    <a href="https://www.apache.org">
                        <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                    </a>
                </div>                
            </div><div class="columns is-gapless">
                <div class="column is-narrow sidemenu">
<div class="container">
                        <nav class="menu">
                            <ul class="menu-list box is-shadowless is-marginless">
                                <li>
                                    <p class="menu-label">
                                        <strong>Documentation</strong>
                                    </p><ul>
                                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>API Docs</strong>
                                    </p><ul>
                                        <li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Support</strong>
                                    </p><ul>
                                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Sitemap</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Project Info</strong>
                                    </p><ul>
                                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Source</strong>
                                    </p><ul>
                                        <li><a href="/repolist.html">Repositories</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Apache Software<br>Foundation</strong>
                                    </p><ul>
                                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li>
                                    </ul>
                                </li><li>
                                    <a class="acevent" data-format="square" data-event="random"></a>
                                </li><li>
                                    <a href="https://apache.org/foundation/contributing.html" class="column">
                                        <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>                    
                </div><div class="column main">
                    <div class="box is-shadowless is-marginless">
                        <div class="level">
                            <div class="pagenav">
<div class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="/">
                                                Home
                                            </a>
                                        </li><li>
                                            <a href="/documentation.html">
                                                Documentation
                                            </a>
                                        </li><li>
                                            <a href="/documentation/bundles.html">
                                                Bundles
                                            </a>
                                        </li><li>
                                            <a href="/documentation/bundles/sling-pipes.html">
                                                Sling Pipes
                                            </a>
                                        </li>
                                    </ul>
                                </div>                                
                            </div><div class="tags">
                                <span class="tag">
                                    <a href="/tags/pipes.html">
                                        pipes
                                    </a>
                                </span>
                            </div>
                        </div><h1 class="title">
                            Sling Pipes Bindings
                        </h1><nav class="menu">
                            <ul class="menu-list box is-shadowless is-paddingless">
                                <li id="generatedToC">
                                    <p class="menu-label">
                                        <strong>Table of Contents</strong>
                                    </p>
                                </li>
                            </ul>
                        </nav><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=title],h2,h3','ulClass':'menu-list'}); } );</script><div class="content is-marginless">
<div class="row"><div><section><p>in order to make things interesting, most of the configuration strings are expressions strings, hence valid JEXL expressions reusing bindings (from configuration, or other pipes). They work the same as JS expressions, except you can't add full JS files.</p>
<p>You can also set whatever scripting engine you want per pipe (including nashorn, rhino, groovy, ...) by setting, at the root pipe level, the property <code>engine</code> to the engine name (as it's registered) you wish.</p>
<h2><a href="#configuration-expression" id="configuration-expression">configuration expression</a></h2>
<p>an expression (path, expr, or property name or value in conf tree) can be either a pure string, like <code>/content/foo/bar</code> or <code>nt:unstructured[title=foo]</code>. But using <em>static</em> expressions like this is rather limited for most of the cases, hence usage of ECMA expressions like <code>/content/${one.value}/bar</code> or more sophisticated using functions <code>nt:unstructured[title=${getValue(currentField)}]</code></p>
<p>In case the expression has an error (bad expression, or undefined variable we'll name <code>bindings</code>) non instanciated expression will be outputed</p>
<h2><a href="#output-binding" id="output-binding">output binding</a></h2>
<p>each single pipe has to declare an output binding at the same time it outputs a resource. The binding will be named as the name of the pipe outputing it. If a pipe as been created as a sub pipe of a container with pipe builder api, it will have default name of &quot;one&quot;, &quot;two&quot;, ... depending on its position in the pipe, you can override the name with <code>.name(...)</code> api.</p>
<p>so following pipe</p>
<pre><code>    echo /content/foo | children nt:unstructured @ name example | write jcr:description='this node property prop = ${example.prop}'
</code></pre>
<p>with following <code>/content/foo</code> tree</p>
<pre><code>    { 
        &quot;jcr:primaryType&quot;:&quot;nt:unstructured&quot;,
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;firstVal&quot;
        },
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;secondVal&quot;
        }
    }
</code></pre>
<p>will loop twice on the pipe <code>example</code>, making available each time for the following pipes' expressions the default binding <code>example</code>, which would be a map with one key prop. Accessing it with <code>{example.prop}</code> would give you <code>firstVal</code> and then <code>secondVal</code>. So resulting tree will be</p>
<pre><code>    { 
        &quot;jcr:primaryType&quot;:&quot;nt:unstructured&quot;,
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;firstVal&quot;
            &quot;jcr:description&quot;:&quot;this node property prop = firstVal&quot;
        },
        &quot;firstItem&quot;: {
            &quot;prop&quot;:&quot;secondVal&quot;
            &quot;jcr:description&quot;:&quot;this node property prop = secondVal&quot;
        }
    }         
</code></pre>
<h2><a href="#additional-bindings" id="additional-bindings">additional bindings</a></h2>
<p><code>additionalBindings</code> is a <a href="/documentation/bundles/sling-pipes/execution-monitoring.html#jcr-persistence-of-a-pipe.html">node you add to any pipe definition</a>, that sets its properties as bindings for this pipe's context execution. you can also add <code>additionalBindings/providers</code> children, that should be read-only pipes that will get executed before this pipe execution, to provide dynamic bindings.</p>
<p>You can also add some through <a href="/documentation/bundles/sling-pipes/execution-monitoring.html#pipe-builder-api">pipe builder api</a> with a map of bindings</p>
<pre><code>    .run(bindings)
</code></pre>
<p>or with a set of key / value pairs</p>
<pre><code>    .runWith(&quot;env&quot;, &quot;prod&quot;)
</code></pre>
<p><a href="/documentation/bundles/sling-pipes/execution-monitoring.html#http-api">http api</a> for this is a binding parameter</p>
<pre><code>    -F bindings='{&quot;env&quot;:&quot;prod&quot;}'
</code></pre>
<p>In case a pipe needs a more dynamic binding, you can use another pipe as binding provider,</p>
<h2><a href="#additional-scripts" id="additional-scripts">additional scripts</a></h2>
<p>some times you want heavy js logic in your expression instantiation. In that case, you need to store your javascript somewhere in the JCR, and mentions the path in the <a href="/documentation/bundles/sling-pipes/execution-monitoring.html#jcr-persistence-of-a-pipe.html">additionalScripts MV property</a></p>
<h2><a href="#bindings-forward" id="bindings-forward">bindings forward</a></h2>
<p>in case a pipe references, or contain another pipe, same binding space will be used</p>
<h2><a href="#context-aware-configuration" id="context-aware-configuration">Context Aware configuration</a></h2>
<p>there is the possibility to use <a href="https://sling.apache.org/documentation/bundles/context-aware-configuration/context-aware-configuration.html">context aware configurations</a> in the bindings like the following: <code>caconfig.pipeName.bucket.property</code> where <code>pipeName</code> is a pipe name, bucket &amp; property typical ca configuration accessors.</p>
</section></div></div>                            
                        </div>
                    </div>
                </div>
            </div><footer class="footer">
                <div class="content has-text-centered is-small">
<div class="editpagelink">
                        This page can be edited on GitHub at <a href="https://github.com/apache/sling-site/edit/master/src/main/jbake/content/documentation/bundles/sling-pipes/bindings.md">
                            content/documentation/bundles/sling-pipes/bindings.md
                        </a>
                    </div>                    <div class="revisionInfo">
                        Last modified by <span class="author">Nicolas Peltier</span> on <span class="comment">2021-03-31</span>
                    </div><p>
                        Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
                    </p><p>
                        Copyright Â© 2007-2022 The Apache Software Foundation.
                    </p>
                </div>
            </footer>
        </div>
    </body>
</html>