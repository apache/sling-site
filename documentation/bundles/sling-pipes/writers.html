<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Writers</title>
        <link rel="icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <script src='https://www.apachecon.com/event-images/snippet.js'></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
	<!-- Matomo Web Analytics -->
	<script>
	var _paq = window._paq = window._paq || [];
	/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
	/* We explicitly disable cookie tracking to avoid privacy issues */
	_paq.push(['disableCookies']); 
	_paq.push(['trackPageView']);
	_paq.push(['enableLinkTracking']);
	(function() {
	  var u="https://matomo.privacy.apache.org/";
	  _paq.push(['setTrackerUrl', u+'matomo.php']);
	  _paq.push(['setSiteId', '6']);
	  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
	  g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
	})();
	</script>
	<!-- End Matomo Code -->
	<link href='/pagefind/pagefind-ui.css' rel='stylesheet'><script src='/pagefind/pagefind-ui.js' type='text/javascript'></script>
	<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#searchbox" });
    });
	</script>
	
    </head>    <body>
        <div class="section">
            <div class="level is-marginless">
<div class="logo">
                    <a href="https://sling.apache.org">
                        <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                    </a>
                </div><div class="header">
                    <a href="https://www.apache.org">
                        <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                    </a>
                </div>                
            </div><section class="searchbox level is-marginless">
                <div id="searchbox"></div>
            </section><div class="columns is-gapless">
                <div class="column is-narrow sidemenu">
<div class="container">
                        <nav class="menu">
                            <ul class="menu-list box is-shadowless is-marginless">
                                <li>
                                    <p class="menu-label">
                                        <strong>Documentation</strong>
                                    </p><ul>
                                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>API Docs</strong>
                                    </p><ul>
                                        <li><a href="/apidocs/sling12/index.html">Sling 12</a></li><li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Support</strong>
                                    </p><ul>
                                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Sitemap</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Project Info</strong>
                                    </p><ul>
                                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Source</strong>
                                    </p><ul>
                                        <li><a href="/repolist.html">Repositories</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Apache Software<br>Foundation</strong>
                                    </p><ul>
                                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li>
                                    </ul>
                                </li><li>
                                    <a class="acevent" data-format="square" data-event="random"></a>
                                </li><li>
                                    <a href="https://apache.org/foundation/contributing.html" class="column">
                                        <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>                    
                </div><div class="column main">
                    <div class="box is-shadowless is-marginless">
                        <div class="level">
                            <div class="pagenav">
<div class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="/">
                                                Home
                                            </a>
                                        </li><li>
                                            <a href="/documentation.html">
                                                Documentation
                                            </a>
                                        </li><li>
                                            <a href="/documentation/bundles.html">
                                                Bundles
                                            </a>
                                        </li><li>
                                            <a href="/documentation/bundles/sling-pipes.html">
                                                Sling Pipes
                                            </a>
                                        </li>
                                    </ul>
                                </div>                                
                            </div><div class="tags">
                                <span class="tag">
                                    <a href="/tags/pipes.html">
                                        pipes
                                    </a>
                                </span>
                            </div>
                        </div><h1 class="title">
                            Writers
                        </h1><nav class="menu">
                            <ul class="menu-list box is-shadowless is-paddingless">
                                <li id="generatedToC">
                                    <p class="menu-label">
                                        <strong>Table of Contents</strong>
                                    </p>
                                </li>
                            </ul>
                        </nav><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=title],h2,h3','ulClass':'menu-list'}); } );</script><div class="content is-marginless">
<div class="row" data-pagefind-body="true"><div><section><p>those pipes all are using common sling (or other) APIs to modify content. You'll probably need some <a href="/documentation/bundles/sling-pipes/readers.html">reader</a> pipes and/or <a href="/documentation/bundles/sling-pipes/logical.html">logical</a> pipes first to put you into the right context.</p>
<h5><a href="#write-pipe-write-" id="write-pipe-write-">Write Pipe (<code>write &lt;...&gt;</code>)</a></h5>
<p>writes given nodes and properties to current input resource</p>
<pre><code>    echo /content/foo | write foo1=bar1 foo2=2 foo3=true foo4=one.old foo5=timeutil.of('2018-05-05T11:50:55+02:00')
</code></pre>
<p>will write <code>@foo1='bar1'</code>, <code>@foo2=2</code>, <code>@foo3=true</code>, <a href="/documentation/bundles/sling-pipes/bindings.html"><code>@foo4=${one.old}</code></a>, and @foo5 being a Date property in <code>/content/foo</code>.</p>
<p>Another handy usage is to copy whole tree sections, using the expr configuration</p>
<pre><code>    echo /content/tree/to/copy/to | write @ expr /content/tree/to/copy/from
</code></pre>
<p>Finally, for more complicated cases where you need a structure to be written, you can use  JCR / Resource explorer to edit the &quot;compiled&quot; persistence of the pipe, and create the given structured under conf. - <code>sling:resourceType</code> is <code>slingPipes/write</code> - <code>conf</code> node tree that will be copied to the current input of the pipe, each property's names and value will be written to the input resource. Input resource will be outputed. Note that properties that will be evaluated (in an expression) as <code>null</code> for a given input resource will be removed from it. E.g. <code>./conf/some/node@prop=${null}</code> will add <code>./conf/some/node</code> structure if not in current input resource, but remove its <code>prop</code> property if any).</p>
<p>Note that you can use expressions in that node tree, and specifically, for a node name, parent of a tree you want to be conditionally written, use <code>$if${...}nodename</code> syntax, that will basically only create such tree if the expression is true.</p>
<h5><a href="#movepipe-mv-expr" id="movepipe-mv-expr">MovePipe (<code>mv &lt;expr&gt;</code>)</a></h5>
<p>JCR move of current input to target path (can be a node or a property)</p>
<pre><code>    echo /content/foo/old/location | mv /content/bar/new/location
</code></pre>
<p>following will move resource at <code>/content/foo/old/oldlocation</code> to under <code>/content/bar/new</code> before <code>newlocation</code></p>
<pre><code>    echo /content/foo/old/oldlocation | mv /content/bar/new/newlocation @ with orderBeforeTarget=true
</code></pre>
<p>following will move resource at <code>/content/foo/old/oldlocation</code> to <code>/content/bar/new/newlocation</code> and overwrite <code>newlocation</code></p>
<pre><code>    echo /content/foo/old/oldlocation | mv /content/bar/new/newlocation @ with overwriteTarget=true
</code></pre>
<h5><a href="#removepipe-rm" id="removepipe-rm">RemovePipe (<code>rm</code>)</a></h5>
<p>removes the input resource, returns the parent, regardless of the resource being a node,</p>
<pre><code>    echo /content/foo/nodeToRemove | rm 
</code></pre>
<p>or a property</p>
<pre><code>    echo /content/foo/node/propertyToRemove | rm
</code></pre>
<p>for more complex use cases, where you need to remove several resources in a row, at different level of a subtree, you can use the &quot;compiled&quot; persistence, where - <code>sling:resourceType</code> is <code>slingPipes/rm</code> - <code>conf</code> node tree that will be used to filter relative properties &amp; subtrees to the current resource to remove. A subnode is considered to be removed if it has no property configured, nore any child.</p>
<h5><a href="#pathpipe-mkdir-expr" id="pathpipe-mkdir-expr">PathPipe (<code>mkdir &lt;expr&gt;</code>)</a></h5>
<p>get or create path given in expression. Uses <a href="https://sling.apache.org/apidocs/sling8/org/apache/sling/api/resource/ResourceUtil.html#getOrCreateResource-org.apache.sling.api.resource.ResourceResolver-java.lang.String-java.lang.String-java.lang.String-boolean-">ResourceUtil.getOrCreateResource</a></p>
<pre><code>    mkdir /content/folders/to/create
</code></pre>
<p>will create a <code>/content/folders/to/create</code> path of <code>sling:Folder</code> nodes</p>
<pre><code>    echo /content/folders/to/create | mkdir childWithDifferentType @ with nodeType=nt:unstructured        
</code></pre>
<p>will create a child with <code>nt:unstructured</code> node type.</p>
<h5><a href="#packagepipe-pkg-expr" id="packagepipe-pkg-expr">PackagePipe (<code>pkg &lt;expr&gt;</code>)</a></h5>
<p>will create a package and add current resource as a filter. At the end of super pipe execution, will attempt to build the package</p>
<p>This example searches for folders in a given location and package them up</p>
<pre><code>    echo /content/foo/bar | $ sling:Folder | pkg /etc/packages/foobar-folders.zip
</code></pre>
<h5><a href="#authorizablepipe-auth-conf" id="authorizablepipe-auth-conf">AuthorizablePipe (<code>auth (conf)</code>)</a></h5>
<p>retrieve authorizable resource corresponding to the id passed in expression, or if not found (or void expression), from the input path, output the found authorizable's resource caution this pipe <strong>can modify content</strong> in case additional configuration is added (see below)</p>
<ul>
<li><code>sling:resourceType</code> is <code>slingPipes/authorizable</code></li>
<li><code>expr</code> should be an authorizable id, or void (but then input should be an authorizable)</li>
<li><code>autoCreateGroup</code> (boolean) if autorizable id is here, but the authorizable not present, then create group with given id (in that case, considered as a write pipe)</li>
<li><code>addMembers</code> (stringified json array) if authorizable is a group, add instanciated members to it (in that case, considered as a write pipe)</li>
<li><code>addToGroup</code> (expression) add found authorizable to instanciated group (in that case, considered as a write pipe)</li>
<li><code>bindMembers</code> (boolean) if found authorizable is a group, bind the members (in that case, considered as a write pipe)</li>
</ul>
<p>This example creates a group</p>
<pre><code>    .auth(&quot;createGroup&quot;, true).expr(&quot;foo-bar&quot;)
</code></pre>
<p>This example searches for users in a given location and add them to <code>foo-bar</code> group</p>
<pre><code>    .echo(&quot;/home/users/foo&quot;)
    .$(&quot;rep:User&quot;)
    .auth(&quot;addToGroup&quot;, &quot;foo-bar&quot;)
</code></pre>
<p>In this example, auth is not writing anything but makes use of bind members and json to create one content tree per admin</p>
<pre><code>    .auth(&quot;bindMembers&quot;,true).expr(&quot;administrators&quot;)
    .json('${one}')
    .mkdir('/content/admin-users/${two}')
</code></pre>
<h5><a href="#aclpipe-acls-allowexpr-denyexpr" id="aclpipe-acls-allowexpr-denyexpr">ACLPipe (<code>acls(), allow(expr), deny(expr)</code>)</a></h5>
<p>either output ACL of current resource in the output bindings, or allow / deny default or configured privileges for the authorizable passed as the expression</p>
<ul>
<li><code>sling:resourceType</code> is <code>slingPipes/acl</code></li>
<li><code>expr</code> should be an authorizable id, or void</li>
<li><code>allow</code> (boolean) to allow some privileges for configured authorizable</li>
<li><code>deny</code> (boolean) to deny some privileges for configured authorizable</li>
</ul>
<p>following will give bar-users authorizable the aggregate privilege (jcr:all) on /content/foo/bar</p>
<pre><code>    echo /content/foo/bar | allow bar-users
</code></pre>
<p>following will give bar-users authorizable the specific rights to read|write on /content/foo/bar</p>
<pre><code>    .echo(&quot;/content/foo/bar&quot;)
    .allow(&quot;bar-users&quot;).with(&quot;jcr:privileges&quot;,[jcr:read,jcr:write]))
</code></pre>
<p>and following will deny bar-users authorizable to read on /content/foo/bar</p>
<pre><code>    echo /content/foo/bar | deny bar-users
</code></pre>
</section></div></div><div data-pagefind-body="true" data-pagefind-weight="7.0" style="display:none;"> - ( Writers )</div>                            
                        </div>
                    </div>
                </div>
            </div><footer class="footer">
                <div class="content has-text-centered is-small">
<div class="editpagelink">
                        This page can be edited on GitHub at <a href="https://github.com/apache/sling-site/edit/master/src/main/jbake/content/documentation/bundles/sling-pipes/writers.md">
                            content/documentation/bundles/sling-pipes/writers.md
                        </a>
                    </div>                    <div class="revisionInfo">
                        Last modified by <span class="author">Nicolas Peltier</span> on <span class="comment">2022-07-22</span>
                    </div><p>
                        Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project
    logo are trademarks of The Apache Software Foundation. All other marks mentioned 
    may be trademarks or registered trademarks of their respective owners.
                    </p><p>
                        Copyright © 2007-2025<a href="https://www.apache.org/">
                            The Apache Software Foundation
                        </a>|<a href="https://privacy.apache.org/policies/privacy-policy-public.html">
                            Privacy Policy
                        </a>
                    </p>
                </div>
            </footer>
        </div>
    </body>
</html>