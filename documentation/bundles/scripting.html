<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Sling Scripting</title>
        <link rel="icon" href="/res/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <script src='https://www.apachecon.com/event-images/snippet.js'></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
    </head>    <body>
        <div class="section">
            <div class="level is-marginless">
<div class="logo">
                    <a href="https://sling.apache.org">
                        <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                    </a>
                </div><div class="header">
                    <a href="https://www.apache.org">
                        <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                    </a>
                </div>                
            </div><div class="columns is-gapless">
                <div class="column is-narrow sidemenu">
<div class="container">
                        <nav class="menu">
                            <ul class="menu-list box is-shadowless is-marginless">
                                <li>
                                    <p class="menu-label">
                                        <strong>Documentation</strong>
                                    </p><ul>
                                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>API Docs</strong>
                                    </p><ul>
                                        <li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Support</strong>
                                    </p><ul>
                                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Site Map</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Project Info</strong>
                                    </p><ul>
                                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Source</strong>
                                    </p><ul>
                                        <li><a href="https://github.com/apache/?utf8=%E2%9C%93&q=sling">GitHub</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Apache Software<br>Foundation</strong>
                                    </p><ul>
                                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li>
                                    </ul>
                                </li><li>
                                    <a class="acevent" data-format="square" data-event="random"></a>
                                </li><li>
                                    <a href="https://apache.org/foundation/contributing.html" class="column">
                                        <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>                    
                </div><div class="column main">
                    <div class="box is-shadowless is-marginless">
                        <div class="level">
                            <div class="pagenav">
<div class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="/">
                                                Home
                                            </a>
                                        </li><li>
                                            <a href="/documentation.html">
                                                Documentation
                                            </a>
                                        </li><li>
                                            <a href="/documentation/bundles.html">
                                                Bundles
                                            </a>
                                        </li>
                                    </ul>
                                </div>                                
                            </div><div class="tags">
                                <span class="tag">
                                    <a href="/tags/scripts.html">
                                        scripts
                                    </a>
                                </span>
                            </div>
                        </div><h1 class="title">
                            Sling Scripting
                        </h1><nav class="menu">
                            <ul class="menu-list box is-shadowless is-paddingless">
                                <li id="generatedToC">
                                    <p class="menu-label">
                                        <strong>Table of Contents</strong>
                                    </p>
                                </li>
                            </ul>
                        </nav><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=title],h2,h3','ulClass':'menu-list'}); } );</script><div class="content is-marginless">
<div class="row"><div><section><p><!-- TODO reactivate TOC once JBake moves to flexmark-java -->
</p>
<h2><a href="#sling-scripting-engines" id="sling-scripting-engines">Sling Scripting Engines</a></h2>
<p>Sling Scripting is build around Java Scripting API (JSR 223). It allows the easy development and usage of different scripting (aka templating) engines.</p>
<p>The script engines are managed in <code>SlingScriptEngineManager</code> (<a href="https://github.com/apache/sling-org-apache-sling-scripting-core">Scripting Core</a>).</p>
<table>
<thead>
<tr><th> Engine </th><th> Language Name </th><th> Language Version </th><th> Names </th><th> Extensions </th><th> Mime Types </th><th> GitHub Repo(s) </th><th> Documentation </th></tr>
</thead>
<tbody>
<tr><td> <a href="https://freemarker.apache.org">FreeMarker</a> </td><td> <code>FreeMarker</code> </td><td> <code>freemarker.template.Configuration#getVersion().toString()</code> </td><td> <code>FreeMarker</code><br><code>freemarker</code><br>(configurable) </td><td> <code>ftl</code><br>(configurable) </td><td> <code>text/x-freemarker</code><br>(configurable) </td><td> <a href="https://github.com/apache/sling-org-apache-sling-scripting-freemarker">sling-org-apache-sling-scripting-freemarker</a> </td><td> </td></tr>
<tr><td> <a href="http://docs.groovy-lang.org/docs/next/html/documentation/template-engines.html#_gstringtemplateengine">Groovy (GString)</a> </td><td> <code>Groovy GString</code> </td><td> <code>org.codehaus.groovy.util.ReleaseInfo#getVersion()</code> </td><td> <code>GString</code><br><code>gstring</code><br>(configurable) </td><td> <code>gst</code><br>(configurable) </td><td> (configurable) </td><td> <a href="https://github.com/apache/sling-org-apache-sling-scripting-groovy">sling-org-apache-sling-scripting-groovy</a> </td><td> </td></tr>
<tr><td> <a href="https://github.com/adobe/htl-spec">HTL</a> </td><td> <code>The HTL Templating Language</code> </td><td> <code>1.4</code> </td><td> <code>htl</code><br><code>HTL</code><br><code>sightly</code> </td><td> <code>html</code> </td><td> </td><td> <a href="https://github.com/apache/sling-org-apache-sling-scripting-sightly">sling-org-apache-sling-scripting-sightly</a> </td><td> <a href="/documentation/bundles/scripting/scripting-htl.html">Scripting HTL</a> </td></tr>
<tr><td> Java </td><td> <code>Java Servlet Compiler</code> </td><td> <code>1.5</code></td><td> <code>java</code><br><code>Java</code> </td><td> <code>java</code> </td><td> </td><td> <a href="https://github.com/apache/sling-org-apache-sling-scripting-java">sling-org-apache-sling-scripting-java</a> </td><td> </td></tr>
<tr><td> JavaScript </td><td> <code>ECMAScript</code> </td><td> <code>partial ECMAScript 2015 support</code> </td><td> <code>rhino</code><br><code>Rhino</code><br><code>javascript</code><br><code>JavaScript</code><br><code>ecmascript</code><br><code>ECMAScript</code> </td><td> <code>esp</code><br><code>ecma</code> </td><td> <code>text/ecmascript</code><br><code>text/javascript</code><br><code>application/ecmascript</code><br><code>application/javascript</code> </td><td> <a href="https://github.com/apache/sling-org-apache-sling-scripting-javascript">sling-org-apache-sling-scripting-javascript</a> </td><td> </td></tr>
<tr><td> <a href="https://projects.eclipse.org/projects/ee4j.jsp">JSP</a> </td><td> <code>Java Server Pages</code> </td><td> <code>2.1</code> </td><td> <code>jsp</code><br><code>JSP</code> </td><td> <code>jsp</code><br><code>jspf</code><br><code>jspx</code> </td><td> </td><td> <a href="https://github.com/apache/sling-org-apache-sling-scripting-jsp">sling-org-apache-sling-scripting-jsp</a> </td><td> <a href="/documentation/bundles/scripting/scripting-jsp.html">Scripting  JSP</a> </td></tr>
<tr><td> <a href="https://www.thymeleaf.org">Thymeleaf</a> </td><td> <code>Thymeleaf</code> </td><td> <code>version</code> from <a href="https://github.com/thymeleaf/thymeleaf/blob/3.0-master/src/main/resources/org/thymeleaf/thymeleaf.properties"><code>/org/thymeleaf/thymeleaf.properties</code></a> </td><td> <code>Thymeleaf</code><br><code>thymeleaf</code><br>(configurable) </td><td> <code>html</code><br>(configurable)  </td><td> <code>text/html</code><br>(configurable)  </td><td> <a href="https://github.com/apache/sling-org-apache-sling-scripting-thymeleaf">sling-org-apache-sling-scripting-thymeleaf</a> </td><td> <a href="/documentation/bundles/scripting/scripting-thymeleaf.html">Scripting Thymeleaf</a> </td></tr>
</tbody>
</table>
<p>Several more engines are available but experimental or no longer maintained:</p>
<ul>
<li>ESX</li>
<li>JST</li>
<li>Python</li>
<li>Ruby</li>
<li>Scala</li>
<li>Velocity</li>
<li>XProc</li>
</ul>
<p>Code for really old modules might be found in the <a href="https://svn.apache.org/repos/asf/sling/attic">svn attic</a>.</p>
<h3><a href="#mapping-script-extensions-to-engines" id="mapping-script-extensions-to-engines">Mapping script extensions to engines</a></h3>
<p>Since version <code>2.0.60</code> <a href="https://github.com/apache/sling-org-apache-sling-scripting-core">Scripting Core</a> supports the mapping of extensions to engines in content (<a href="https://issues.apache.org/jira/browse/SLING-4330">SLING-4330</a>).</p>
<p>This is required when registering more than one script engine for a single script extension (e.g. using HTL for <em>vendor-related</em> scripts in <code>/libs</code> and Thymeleaf for <em>project-related</em> scripts in <code>/apps</code>, both using extension <code>html</code>).</p>
<p>It works by adding a <code>sling:scripting</code> property to the script resource or a resource in the hierarchy above the script (e.g. project or parent folder).</p>
<p>The mapping consists of a <em>key</em> which is the <em>script extension</em> and a <em>value</em> which itself could consist of four values separated by colon to identify the script engine:</p>
<ol>
<li>language name (required)</li>
<li>language version (optional)</li>
<li>engine name (not used yet)</li>
<li>engine version (not used yet)</li>
</ol>
<p>The <code>sling:scripting</code> property supports multiple mappings for different extensions (e.g. <code>html</code> and <code>js</code>).</p>
<p>In case there is more than one script engine for a script extension registered and no mapping is found the script engine with higher service ranking gets used for rendering.</p>
<h4><a href="#sample-mappings" id="sample-mappings">Sample mappings</a></h4>
<p>Mapping <code>html</code> to HTL 1.4:</p>
<pre><code>&quot;sling:scripting&quot;: [
  &quot;html=The HTL Templating Language:1.4&quot;
]
</code></pre>
<p>Mapping <code>html</code> to Thymeleaf 3.0:</p>
<pre><code>&quot;sling:scripting&quot;: [
  &quot;html=Thymeleaf:3.0&quot;
]
</code></pre>
<h2><a href="#script-encoding" id="script-encoding">Script encoding</a></h2>
<p>All scripts backed by Sling resources get their character encoding from the <a href="../the-sling-engine/resources.html#resource-properties">character encoding set in the resource metadata</a>. For JCR based resources this is retrieved from the underlying <code>jcr:encoding</code> JCR property. If not set it will fall back to UTF-8.</p>
<p>Every script evaluation in the context of a request sets the response's character encoding to UTF-8 (if the request accepts content types starting with <code>text/</code>)</p>
<h2><a href="#scripting-variables" id="scripting-variables">Scripting variables</a></h2>
<p>See also <a href="https://cwiki.apache.org/confluence/display/SLING/Scripting+variables">Scripting variables</a> and <a href="https://cwiki.apache.org/confluence/display/SLING/Adding+New+Scripting+Variables">Adding New Scripting Variables</a>.</p>
</section></div></div>                            
                        </div>
                    </div>
                </div>
            </div><footer class="footer">
                <div class="content has-text-centered is-small">
<div class="revisionInfo">
                        Last modified by <span class="author">Konrad Windszus</span> on <span class="comment">2021-07-26</span>
                    </div>                    <p>
                        Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project logo are trademarks of The Apache Software Foundation. All other marks mentioned may be trademarks or registered trademarks of their respective owners.
                    </p><p>
                        Copyright Â© 2007-2021 The Apache Software Foundation.
                    </p>
                </div>
            </footer>
        </div>
    </body>
</html>