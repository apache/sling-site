<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Managing users and groups (jackrabbit.usermanager)</title>
        <link rel="icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <script src='https://www.apachecon.com/event-images/snippet.js'></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
	<!-- Matomo Web Analytics -->
	<script>
	var _paq = window._paq = window._paq || [];
	/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
	/* We explicitly disable cookie tracking to avoid privacy issues */
	_paq.push(['disableCookies']); 
	_paq.push(['trackPageView']);
	_paq.push(['enableLinkTracking']);
	(function() {
	  var u="https://matomo.privacy.apache.org/";
	  _paq.push(['setTrackerUrl', u+'matomo.php']);
	  _paq.push(['setSiteId', '6']);
	  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
	  g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
	})();
	</script>
	<!-- End Matomo Code -->
	<link href='/pagefind/pagefind-ui.css' rel='stylesheet'><script src='/pagefind/pagefind-ui.js' type='text/javascript'></script>
	<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#searchbox" });
    });
	</script>
	
    </head>    <body>
        <div class="section">
            <div class="level is-marginless">
<div class="logo">
                    <a href="https://sling.apache.org">
                        <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                    </a>
                </div><div class="header">
                    <a href="https://www.apache.org">
                        <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                    </a>
                </div>                
            </div><section class="searchbox level is-marginless">
                <div id="searchbox"></div>
            </section><div class="columns is-gapless">
                <div class="column is-narrow sidemenu">
<div class="container">
                        <nav class="menu">
                            <ul class="menu-list box is-shadowless is-marginless">
                                <li>
                                    <p class="menu-label">
                                        <strong>Documentation</strong>
                                    </p><ul>
                                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>API Docs</strong>
                                    </p><ul>
                                        <li><a href="/apidocs/sling12/index.html">Sling 12</a></li><li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Support</strong>
                                    </p><ul>
                                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Sitemap</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Project Info</strong>
                                    </p><ul>
                                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Source</strong>
                                    </p><ul>
                                        <li><a href="/repolist.html">Repositories</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Apache Software<br>Foundation</strong>
                                    </p><ul>
                                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li>
                                    </ul>
                                </li><li>
                                    <a class="acevent" data-format="square" data-event="random"></a>
                                </li><li>
                                    <a href="https://apache.org/foundation/contributing.html" class="column">
                                        <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>                    
                </div><div class="column main">
                    <div class="box is-shadowless is-marginless">
                        <div class="level">
                            <div class="pagenav">
<div class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="/">
                                                Home
                                            </a>
                                        </li><li>
                                            <a href="/documentation.html">
                                                Documentation
                                            </a>
                                        </li><li>
                                            <a href="/documentation/bundles.html">
                                                Bundles
                                            </a>
                                        </li>
                                    </ul>
                                </div>                                
                            </div><div class="tags">
                                <span class="tag">
                                    <a href="/tags/security.html">
                                        security
                                    </a>
                                </span>
                            </div>
                        </div><h1 class="title">
                            Managing users and groups (jackrabbit.usermanager)
                        </h1><nav class="menu">
                            <ul class="menu-list box is-shadowless is-paddingless">
                                <li id="generatedToC">
                                    <p class="menu-label">
                                        <strong>Table of Contents</strong>
                                    </p>
                                </li>
                            </ul>
                        </nav><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=title],h2,h3','ulClass':'menu-list'}); } );</script><div class="content is-marginless">
<div class="row" data-pagefind-body="true"><div><section><p>The <code>jackrabbit-usermanager</code> bundle delivers a REST interface to create, update and delete users and groups in the JCR. After installing the <code>jackrabbit-usermanager</code> bundle all REST services are exposed under the path <code>/system/userManager</code>. Its interface for modifing/creating authorizables is similar to the <a href="/documentation/bundles/manipulating-content-the-slingpostservlet-servlets-post.html">SlingPostServlet</a>.</p>
<p>For getting information about existing authorizables it provides all authorizables as Sling resources through its <code>AuthorizableResourceProvider</code> below <code>/system/userManager/user</code> and <code>/system/userManager/group</code>. Those resources can be exposed via the <a href="/documentation/bundles/rendering-content-default-get-servlets.html">Default GET Servlet</a>.</p>
<p><!-- TODO reactivate TOC once JBake moves to flexmark-java -->
</p>
<h2><a href="#list-users" id="list-users">List users</a></h2>
<p>To list existing users a GET request to the <code>/system/userManager/user</code> resource can be issued. Depending on the configuration of the <a href="/documentation/bundles/rendering-content-default-get-servlets.html">Default GET Servlet</a> and/or the availability of a Servlet or Script handling the <code>sling/users</code> resource type, a result may be delivered/</p>
<p>Example with curl and the default JSON rendering:</p>
<pre><code>$ curl http://localhost:8080/system/userManager/user.tidy.1.json
{
  &quot;admin&quot;: {
    &quot;memberOf&quot;: [],
    &quot;declaredMemberOf&quot;: []
  },
  &quot;anonymous&quot;: {
    &quot;memberOf&quot;: [],
    &quot;declaredMemberOf&quot;: []
  }
}
</code></pre>
<h2><a href="#get-user" id="get-user">Get user</a></h2>
<p><em>since version 2.0.8</em> The properties of a single user can be retrieved by sending a GET request to the user's resource at <code>/system/userManager/user/&lt;username&gt;</code> where <code>&lt;username&gt;</code> would be replaced with the name of the user.  Depending on the configuration of the <a href="/documentation/bundles/rendering-content-default-get-servlets.html">Default GET Servlet</a> and/or the availability of a Servlet or Script handling the <code>sling/user</code> resource type, a result may be delivered.</p>
<p>Example with curl and the default JSON rendering:</p>
<pre><code>$ curl http://localhost:8080/system/userManager/user/admin.tidy.1.json
{
    &quot;memberOf&quot;: [],
    &quot;declaredMemberOf&quot;: []
}
</code></pre>
<p>If a non-existing user is requested a <code>404/NOT FOUND</code> status is sent back.</p>
<h2><a href="#create-user" id="create-user">Create user</a></h2>
<p>To create a new user POST a request to <code>/system/userManager/user.create.&lt;html or json&gt;</code>. The following parameters are available:</p>
<p>One of these to resolve the user name:</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Since Version </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>:name</code> </td><td> no </td><td> </td><td> The value is the exact name to use</td></tr>
<tr><td><code>:name@ValueFrom</code> </td><td> no </td><td> 2.2.16 </td><td> The value is the name of another submitted parameter whose value is the exact name to use</td></tr>
<tr><td><code>:nameHint</code> </td><td> no </td><td> 2.2.16 </td><td> The value is filtered, trimmed and made unique</td></tr>
<tr><td><code>:nameHint@ValueFrom</code> </td><td> no </td><td> 2.2.16 </td><td> The value is the name of another submitted parameter whose value is filtered, trimmed and made unique</td></tr>
<tr><td><code>otherwise</code> </td><td> </td><td> 2.2.16 </td><td> Try the value of any server-side configured &quot;principalNameHints&quot; parameter to treat as a hint that is filtered, trimmed and made unique</td></tr>
</tbody>
</table>
<p>... and these ...</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Since Version </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>pwd</code> </td><td> yes </td><td> </td><td> The password of the new user</td></tr>
<tr><td><code>pwdConfirm</code> </td><td> yes </td><td> </td><td> The password of the new user (must be equal to the value of <code>pwd</code>)</td></tr>
<tr><td><code>:disabled</code> </td><td> no </td><td> 2.1.1 </td><td> If <code>true</code> disables the user to block further login attempts. If <code>false</code> enables a disabled user.</td></tr>
<tr><td><code>:disabledReason</code> </td><td> no </td><td> 2.1.1 </td><td>Specifies the reason why a user has been disabled.</td></tr>
<tr><td><code>jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the storage node properties in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;anyproperty&gt;</code> </td><td> no </td><td> </td><td> Additional non-nested parameters will be stored as node properties in the JCR.</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:primaryType</code> </td><td> no </td><td> 2.2.18 </td><td> Specifies the primary type for a new nested storage node at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the nested storage node properties at the relative path  in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/&lt;anyproperty&gt;</code> </td><td> no </td><td> 2.2.6 </td><td> Additional parameters will be stored as nested node properties at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-6747">SLING-6747</a>)</td></tr>
</tbody>
</table>
<p>Responses:</p>
<table>
<thead>
<tr><th>Status Code </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td>200 </td><td> Success, a redirect is sent to the users resource locator with HTML (or JSON) describing status.</td></tr>
<tr><td>500 </td><td> Failure, including user already exists. HTML (or JSON) explains failure.</td></tr>
</tbody>
</table>
<p>Example with curl:</p>
<pre><code>curl -F:name=myuser -Fpwd=password -FpwdConfirm=password -Fanyproperty1=value1 \
    http://localhost:8080/system/userManager/user.create.html
</code></pre>
<h2><a href="#update-user" id="update-user">Update user</a></h2>
<p>To update an existing user POST a request to <code>/system/userManager/user/username.update.&lt;html or json&gt;</code>. You can NOT update the username or the password (see Change Password below) only the additional properties are updateable through this URL. The following parameters are available:</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Since Version </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>:disabled</code> </td><td> no </td><td> 2.1.1 </td><td> If <code>true</code> disables the user to block further login attempts. If <code>false</code> enables a disabled user.</td></tr>
<tr><td><code>:disabledReason</code> </td><td> no </td><td> 2.1.1 </td><td> Specifies the reason why a user has been disabled.</td></tr>
<tr><td><code>jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the storage node properties in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>jcr:mixinType@Delete</code> </td><td> no </td><td> 2.2.18 </td><td> Removes a mixin type from the storage node properties in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;anyproperty&gt;</code> </td><td> no </td><td> </td><td> Additional non-nested parameters will be stored as node properties in the JCR.</td></tr>
<tr><td><code>&lt;anyproperty&gt;@Delete</code> </td><td> no </td><td> </td><td> Non-nested properties with @Delete at the end of the name will be deleted in the JCR.</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:primaryType</code> </td><td> no </td><td> 2.2.18 </td><td> Specifies the primary type for a new nested storage node at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the nested storage node properties at the relative path  in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:mixinType@Delete</code> </td><td> no </td><td> 2.2.18 </td><td> Removes a mixin type from the nested storage node properties at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/&lt;anyproperty&gt;</code> </td><td> no </td><td> 2.2.6 </td><td> Additional parameters will be stored as nested node properties at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-6747">SLING-6747</a>).</td></tr>
<tr><td><code>&lt;relPath&gt;/&lt;anyproperty&gt;@Delete</code> </td><td> no </td><td> 2.2.6 </td><td> Nested properties with @Delete at the end of the name will be deleted at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-6747">SLING-6747</a>).</td></tr>
</tbody>
</table>
<p>Responses:</p>
<table>
<thead>
<tr><th>Status Code </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td>200 </td><td> Success, a redirect is sent to the users resource locator with HTML (or JSON) describing status.</td></tr>
<tr><td>404 </td><td> User was not found.</td></tr>
<tr><td>500 </td><td> Any other failure. HTML (or JSON) explains failure.</td></tr>
</tbody>
</table>
<p>Example</p>
<pre><code>curl -Fanyproperty1@Delete -Fproperty2=value2 \
    http://localhost:8080/system/userManager/user/myuser.update.html
</code></pre>
<h2><a href="#change-password" id="change-password">Change password</a></h2>
<p>To change a password of an existing user POST a request to <code>/system/userManager/user/username.changePassword.&lt;html or json&gt;</code>. NOTE: since version 2.1.1, the oldPwd is optional if the current user is a user administrator.  The following parameters are available:</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>oldPwd</code> </td><td> yes </td><td> Old password.</td></tr>
<tr><td><code>newPwd</code> </td><td> yes </td><td> New password.</td></tr>
<tr><td><code>newPwdConfirm</code> </td><td> yes </td><td> New password (must be equal to the value of <code>newPwd</code>).</td></tr>
</tbody>
</table>
<p>Responses:</p>
<table>
<thead>
<tr><th>Status Code </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td>200 </td><td> Success, no body.</td></tr>
<tr><td>404 </td><td> User was not found.</td></tr>
<tr><td>500 </td><td> Any other failure. HTML (or JSON) explains failure.</td></tr>
</tbody>
</table>
<p>Example</p>
<pre><code>curl -FoldPwd=oldpassword -FnewPwd=newpassword -FnewPwdConfirm=newpassword \
    http://localhost:8080/system/userManager/user/myuser.changePassword.html
</code></pre>
<h2><a href="#delete-user" id="delete-user">Delete user</a></h2>
<p>To delete an existing user POST a request to <code>/system/userManager/user/username.delete.&lt;html or json&gt;</code>. The following parameters are available:</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>:applyTo</code> </td><td> no </td><td> An array of relative resource references to users to be deleted. If this parameter is present, the username from the URL is ignored and all listed users are removed.</td></tr>
</tbody>
</table>
<p>Responses:</p>
<table>
<thead>
<tr><th>Status Code </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td>200 </td><td> Success, no body.</td></tr>
<tr><td>404 </td><td> User(s) was/were not found.</td></tr>
<tr><td>500 </td><td> Any other failure. HTML (or JSON) explains failure.</td></tr>
</tbody>
</table>
<p>Example</p>
<pre><code>curl -Fgo=1 http://localhost:8080/system/userManager/user/myuser.delete.html
</code></pre>
<h2><a href="#list-groups" id="list-groups">List groups</a></h2>
<p>To list existing groups a GET request to the <code>/system/userManager/group</code> resource can be sent. Depending on the configuration of the <a href="/documentation/bundles/rendering-content-default-get-servlets.html">Default GET Servlet</a> and/or the availability of a Servlet or Script handling the <code>sling/groups</code> resource type, a result may be delivered.</p>
<p>Example with curl and the default JSON rendering:</p>
<pre><code>$ curl http://localhost:8080/system/userManager/group.tidy.1.json
{
  &quot;UserAdmin&quot;: {
    &quot;members&quot;: [],
    &quot;declaredMembers&quot;: [],
    &quot;memberOf&quot;: [],
    &quot;declaredMemberOf&quot;: []
  },
  &quot;GroupAdmin&quot;: {
    &quot;members&quot;: [],
    &quot;declaredMembers&quot;: [],
    &quot;memberOf&quot;: [],
    &quot;declaredMemberOf&quot;: []
   },
  &quot;administrators&quot;: {
    &quot;members&quot;: [],
    &quot;declaredMembers&quot;: [],
    &quot;memberOf&quot;: [],
    &quot;declaredMemberOf&quot;: []
}
}
</code></pre>
<h2><a href="#get-group" id="get-group">Get group</a></h2>
<p>The properties of a single group can be retrieved by sending a GET request to the group's resource at <code>/system/userManager/group/groupname</code> where <em>groupname</em> would be replaced with the name of the group.  Depending on the configuration of the <a href="/documentation/bundles/rendering-content-default-get-servlets.html">Default GET Servlet</a> and/or the availability of a Servlet or Script handling the <code>sling/group</code> resource type, a result may be delivered.</p>
<p>Example with curl and the default JSON rendering:</p>
<pre><code>$ curl http://localhost:8080/system/userManager/group/administrators.tidy.1.json
{
    &quot;members&quot;: [],
    &quot;declaredMembers&quot;: [],
    &quot;memberOf&quot;: [],
    &quot;declaredMemberOf&quot;: []
}
</code></pre>
<p>If a non-existing group is requested a 404/NOT FOUND status is sent back.</p>
<h2><a href="#create-group" id="create-group">Create group</a></h2>
<p>To create a new group POST a request to <code>/system/userManager/group.create.&lt;html or json&gt;</code>. The following parameters are available:</p>
<p>One of these to resolve the group name:</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Since Version </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>:name</code> </td><td> no </td><td> </td><td> The value is the exact name to use</td></tr>
<tr><td><code>:name@ValueFrom</code> </td><td> no </td><td> 2.2.16 </td><td> The value is the name of another submitted parameter whose value is the exact name to use</td></tr>
<tr><td><code>:nameHint</code> </td><td> no </td><td> 2.2.16 </td><td> The value is filtered, trimmed and made unique</td></tr>
<tr><td><code>:nameHint@ValueFrom</code> </td><td> no </td><td> 2.2.16 </td><td> The value is the name of another submitted parameter whose value is filtered, trimmed and made unique</td></tr>
<tr><td><code>otherwise</code> </td><td>  </td><td> 2.2.16 </td><td> Try the value of any server-side configured &quot;principalNameHints&quot; parameter to treat as a hint that is filtered, trimmed and made unique</td></tr>
</tbody>
</table>
<p>... and these ...</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Since Version </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the storage node properties in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;anyproperty&gt;</code> </td><td> no </td><td> </td><td> Additional non-nested parameters will be stored as node properties in the JCR.</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:primaryType</code> </td><td> no </td><td> 2.2.18 </td><td> Specifies the primary type for a new nested storage node at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the nested storage node properties at the relative path  in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/&lt;anyproperty&gt;</code> </td><td> no </td><td> 2.2.6 </td><td> Additional parameters will be stored as nested node properties at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-6747">SLING-6747</a>)</td></tr>
</tbody>
</table>
<p>Responses:</p>
<table>
<thead>
<tr><th>Status Code </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td>200 </td><td> Success, a redirect is sent to the group resource locator with HTML (or JSON) describing status</td></tr>
<tr><td>500 </td><td> Failure including group already exists. HTML (or JSON) explains failure.</td></tr>
</tbody>
</table>
<p>Example with curl:</p>
<pre><code>curl -F:name=mygroup -Fanyproperty1=value1 \
    http://localhost:8080/system/userManager/group.create.html
</code></pre>
<h2><a href="#update-group" id="update-group">Update group</a></h2>
<p>To update an existing group POST a request to <code>/system/userManager/group/groupname.update.&lt;html or json&gt;</code>. You can NOT update the name of the group only the additional properties are updateable. The following parameters are available:</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Since Version </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>:member</code> </td><td> no </td><td> </td><td> user(s) (name or URI) to add to the group as a member. Can also be an array of users.</td></tr>
<tr><td><code>:member@Delete</code> </td><td> no </td><td> </td><td> user(s) (name or URI) to remove from the group. Can also be an array of users.</td></tr>
<tr><td><code>jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the storage node properties in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>jcr:mixinType@Delete</code> </td><td> no </td><td> 2.2.18 </td><td> Removes a mixin type from the storage node properties in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;anyproperty&gt;</code> </td><td> no </td><td> </td><td> Additional non-nested parameters will be stored as node properties in the JCR.</td></tr>
<tr><td><code>&lt;anyproperty&gt;@Delete</code> </td><td> no </td><td> </td><td> Non-nested properties with @Delete at the end of the name will be deleted in the JCR.</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:primaryType</code> </td><td> no </td><td> 2.2.18 </td><td> Specifies the primary type for a new nested storage node at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:mixinType</code> </td><td> no </td><td> 2.2.18 </td><td> Adds a mixin type to the nested storage node properties at the relative path  in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/jcr:mixinType@Delete</code> </td><td> no </td><td> 2.2.18 </td><td> Removes a mixin type from the nested storage node properties at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-11023">SLING-11023</a>)</td></tr>
<tr><td><code>&lt;relPath&gt;/&lt;anyproperty&gt;</code> </td><td> no </td><td> 2.2.6 </td><td> Additional parameters will be stored as nested node properties at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-6747">SLING-6747</a>).</td></tr>
<tr><td><code>&lt;relPath&gt;/&lt;anyproperty&gt;@Delete</code> </td><td> no </td><td> 2.2.6 </td><td> Nested properties with @Delete at the end of the name will be deleted at the relative path in the JCR. (<a href="https://issues.apache.org/jira/browse/SLING-6747">SLING-6747</a>).</td></tr>
</tbody>
</table>
<p>Responses:</p>
<table>
<thead>
<tr><th>Status Code </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td>200 </td><td> Success, a redirect is sent to the group resource locator with HTML (or JSON) describing status.</td></tr>
<tr><td>404 </td><td> Group was not found.</td></tr>
<tr><td>500 </td><td> Any other failure. HTML (or JSON) explains failure.</td></tr>
</tbody>
</table>
<p>Example</p>
<pre><code>curl -Fanyproperty1@Delete -Fproperty2=value2 -F &quot;:member=/system/userManager/user/myuser&quot; \
    http://localhost:8080/system/userManager/group/mygroup.update.html
</code></pre>
<h2><a href="#delete-group" id="delete-group">Delete group</a></h2>
<p>To delete an existing group POST a request to <code>/system/userManager/group/groupname.delete.&lt;html or json&gt;</code>. The following parameters are available:</p>
<table>
<thead>
<tr><th>Parameter Name </th><th> Required </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td><code>:applyTo</code> </td><td> no </td><td> An array of relative resource references to groups to be deleted. If this parameter is present, the name of the group from the URL is ignored and all listed groups are removed.</td></tr>
</tbody>
</table>
<p>Responses:</p>
<table>
<thead>
<tr><th>Status Code </th><th> Description</th></tr>
</thead>
<tbody>
<tr><td>200 </td><td> Success, sent with no body.</td></tr>
<tr><td>404 </td><td> Group(s) was/were not found.</td></tr>
<tr><td>500 </td><td> Any other failure. HTML (or JSON) explains failure.</td></tr>
</tbody>
</table>
<p>Example</p>
<pre><code>curl -Fgo=1 http://localhost:8080/system/userManager/group/mygroup.delete.html
</code></pre>
<h2><a href="#automated-tests" id="automated-tests">Automated Tests</a></h2>
<p>The <a href="https://github.com/apache/sling-org-apache-sling-launchpad-integration-tests/blob/master/src/main/java/org/apache/sling/launchpad/webapp/integrationtest/accessManager/">launchpad/testing</a> module contains test classes for various operations of the <code>jackrabbit-usermanager</code>. Such tests run as part of our continuous integration process, to demonstrate and verify the behavior of the various operations, in a way that's guaranteed to be in sync with the actual Sling core code. If you have an idea for additional tests, make sure to let us know!</p>
<h2><a href="#permissions-checking-from-scripts" id="permissions-checking-from-scripts">Permissions checking from scripts</a></h2>
<p><em>Since Version 2.0.6</em></p>
<p>When developing scripts that will perform user or group updates, you may want to know what actions the current user is provisioned to do.  This information can be used to conditionally render parts of your page differently based on the user rights.</p>
<p>The jackrabbit.usermanager bundle provides a service (AuthorizablePrivilegesInfo) you can utilize to do help with this permission checking.</p>
<p>The AuthorizablePrivilegesInfo provides methods for checking the following actions</p>
<table>
<thead>
<tr><th> Method </th><th> Description </th></tr>
</thead>
<tbody>
<tr><td> <code>canAddUser(jcrSession)</code> </td><td> Checks if the current user may add new users </td></tr>
<tr><td> <code>canAddGroup(jcrSession)</code> </td><td> Checks if the current user may add new groups </td></tr>
<tr><td> <code>canUpdateProperties(jcrSession, principalId)</code> </td><td> Checks if the current user may update the properties of the specified principal </td></tr>
<tr><td> <code>canRemove(jcrSession, principalId)</code> </td><td> Checks if the current user may remove the specified user or group </td></tr>
<tr><td> <code>canUpdateGroupMembers(jcrSession, groupId)</code> </td><td> Checks if the current user may modify the membership of the specified group </td></tr>
</tbody>
</table>
<p>Example:</p>
<pre><code>&lt;%
    // lookup the service
    var privilegesInfo = sling.getService(Packages.org.apache.sling.jackrabbit.usermanager.AuthorizablePrivilegesInfo);

    if (privilegesInfo.canAddUser(currentSession)) {
        //TODO: render the UI that allows the user to add a user here
    }

    if (privilegesInfo.canAddGroup(currentSession)) {
        //TODO: render the UI that allows the user to add a group here
    }

    if (privilegesInfo.canUpdateProperties(currentSession, &quot;someUserId&quot;)) {
        //TODO: render the UI that allows the user to update the properties of the user here
    }

    if (privilegesInfo.canRemove(currentSession, &quot;someUserId&quot;)) {
        //TODO: render the UI that allows the user to remove the user here
    }

    if (privilegesInfo.canUpdateGroupMembers(currentSession, &quot;GroupName&quot;)) {
        //TODO: draw your UI that allows the user to update the group memebership here
    }
%&gt;
</code></pre>
<h2><a href="#changing-the-root-path-for-usermanager-resources" id="changing-the-root-path-for-usermanager-resources">Changing the root path for usermanager resources</a></h2>
<p><em>Since Version 2.2.12</em></p>
<p>By default, the usermanager resources are provided under the /system/userManager path.  This location may be changed via configuration.</p>
<p>For example:</p>
<pre><code>&quot;org.apache.sling.jackrabbit.usermanager.impl.resource.AuthorizableResourceProvider&quot;:{
    &quot;provider.root&quot;:&quot;/people&quot;,
}
</code></pre>
<h2><a href="#generating-principal-names-from-a-hint" id="generating-principal-names-from-a-hint">Generating principal names from a hint</a></h2>
<p><em>Since Version 2.2.16</em></p>
<p>For use cases where the exact principalName value isn't critical, a unique value can be auto-generated from some other hint. With a generated unique princpalName, the end user doesn't have to keep retrying to find a value that hasn't been used already.</p>
<p>With the default behavior, the principalName value would be determined by locating the first request parameter that is a match of one of the choices in the following order:</p>
<p>1. <strong>:name</strong> - value is the exact name to use</p>
<pre><code>curl -F:name=myuser -Fpwd=password -FpwdConfirm=password http://localhost:8080/system/userManager/user.create.html
</code></pre>
<p>2. <strong>:name@ValueFrom</strong> - value is the name of another submitted parameter whose value is the exact name to use</p>
<pre><code>curl -F:name@ValueFrom=displayName -FdisplayName=myuser -Fpwd=password -FpwdConfirm=password http://localhost:8080/system/userManager/user.create.html
</code></pre>
<p>3. <strong>:nameHint</strong> - value is filtered, trimmed and made unique</p>
<pre><code>curl -F:nameHint=myuser -Fpwd=password -FpwdConfirm=password http://localhost:8080/system/userManager/user.create.html
</code></pre>
<p>4. <strong>:nameHint@ValueFrom</strong> - value is the name of another submitted parameter whose value is filtered, trimmed and made unique</p>
<pre><code>curl -F:nameHint@ValueFrom=displayName -FdisplayName=myuser -Fpwd=password -FpwdConfirm=password http://localhost:8080/system/userManager/user.create.html
</code></pre>
<p>5. <strong>otherwise</strong>, try the value of any server-side configured &quot;principalNameHints&quot; parameters to treat as a hint that is filtered, trimmed and made unique</p>
<pre><code>curl -FdisplayName=myuser -Fpwd=password -FpwdConfirm=password http://localhost:8080/system/userManager/user.create.html
</code></pre>
<h4><a href="#customizing-how-principal-names-are-generated-from-a-hint" id="customizing-how-principal-names-are-generated-from-a-hint">Customizing how principal names are generated from a hint</a></h4>
<p><em>Since Version 2.2.16</em></p>
<p>The default implementation of <em>PrincipalNameGenerator</em> may be adjusted via configuration to define a length limit and define which request parameters should be considered as hint candidates.</p>
<p>For example:</p>
<pre><code>&quot;org.apache.sling.jackrabbit.usermanager.PrincipalNameGenerator&quot;:{
    &quot;principalNameMaxLength&quot;: 50,
    &quot;principalNameHints&quot;: [
        &quot;displayName&quot;
    ]
}
</code></pre>
<p>Additionally, the following service interfaces may be implemented by a custom OSGi component in order to influence how a principalName is generated from a hint. Whichever registered OSGi service that has the highest <em>service.ranking</em> value will be used.</p>
<ol>
<li><strong>org.apache.sling.jackrabbit.usermanager.PrincipalNameFilter</strong> - An implementation of this service interface allows for filtering what characters are allowed in a generated principal name</li>
<li><strong>org.apache.sling.jackrabbit.usermanager.PrincipalNameGenerator</strong> - An implementation of this service interface allows to fully customize principal name generation</li>
</ol>
<h2><a href="#enabling-the-option-to-expose-nested-authorizable-property-containers-as-child-resources" id="enabling-the-option-to-expose-nested-authorizable-property-containers-as-child-resources">Enabling the option to expose nested authorizable property containers as child resources</a></h2>
<p><em>Since Version 2.2.18</em></p>
<p>By default, the nested authorizable property containers are not exposed as child resources.  This behavior may be enabled via configuration.</p>
<p>For example:</p>
<pre><code>&quot;org.apache.sling.jackrabbit.usermanager.impl.resource.AuthorizableResourceProvider&quot;:{
    &quot;resources.for.nested.properties&quot;:true
}
</code></pre>
</section></div></div><div data-pagefind-body="true" data-pagefind-weight="7.0" style="display:none;"> - ( Managing users and groups (jackrabbit.usermanager) )</div>                            
                        </div>
                    </div>
                </div>
            </div><footer class="footer">
                <div class="content has-text-centered is-small">
<div class="editpagelink">
                        This page can be edited on GitHub at <a href="https://github.com/apache/sling-site/edit/master/src/main/jbake/content/documentation/bundles/managing-users-and-groups-jackrabbit-usermanager.md">
                            content/documentation/bundles/managing-users-and-groups-jackrabbit-usermanager.md
                        </a>
                    </div>                    <div class="revisionInfo">
                        Last modified by <span class="author">Eric Norman</span> on <span class="comment">2022-02-04</span>
                    </div><p>
                        Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project
    logo are trademarks of The Apache Software Foundation. All other marks mentioned 
    may be trademarks or registered trademarks of their respective owners.
                    </p><p>
                        Copyright © 2007-2024<a href="https://www.apache.org/">
                            The Apache Software Foundation
                        </a>|<a href="https://privacy.apache.org/policies/privacy-policy-public.html">
                            Privacy Policy
                        </a>
                    </p>
                </div>
            </footer>
        </div>
    </body>
</html>