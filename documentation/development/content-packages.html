<!DOCTYPE html><html lang="en">
<head>
        <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
        <title>Apache Sling :: Content-Package based development</title>
        <link rel="icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css"/>
        <link rel="stylesheet" href="/res/css/site.css"/>
        <script src='https://www.apachecon.com/event-images/snippet.js'></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js'></script><script>
            hljs.initHighlightingOnLoad();
        </script>
        
	<!-- Matomo Web Analytics -->
	<script>
	var _paq = window._paq = window._paq || [];
	/* tracker methods like "setCustomDimension" should be called before "trackPageView" */
	/* We explicitly disable cookie tracking to avoid privacy issues */
	_paq.push(['disableCookies']); 
	_paq.push(['trackPageView']);
	_paq.push(['enableLinkTracking']);
	(function() {
	  var u="https://matomo.privacy.apache.org/";
	  _paq.push(['setTrackerUrl', u+'matomo.php']);
	  _paq.push(['setSiteId', '6']);
	  var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
	  g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
	})();
	</script>
	<!-- End Matomo Code -->
	<link href='/pagefind/pagefind-ui.css' rel='stylesheet'><script src='/pagefind/pagefind-ui.js' type='text/javascript'></script>
	<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        new PagefindUI({ element: "#searchbox" });
    });
	</script>
	
    </head>    <body>
        <div class="section">
            <div class="level is-marginless">
<div class="logo">
                    <a href="https://sling.apache.org">
                        <img border="0" alt="Apache Sling" src="/res/logos/sling.svg"/>
                    </a>
                </div><div class="header">
                    <a href="https://www.apache.org">
                        <img border="0" alt="Apache" src="/res/logos/apache.png"/>
                    </a>
                </div>                
            </div><section class="searchbox level is-marginless">
                <div id="searchbox"></div>
            </section><div class="columns is-gapless">
                <div class="column is-narrow sidemenu">
<div class="container">
                        <nav class="menu">
                            <ul class="menu-list box is-shadowless is-marginless">
                                <li>
                                    <p class="menu-label">
                                        <strong>Documentation</strong>
                                    </p><ul>
                                        <li><a href="/documentation.html">Overview</a></li><li><a href="/documentation/getting-started.html">Getting Started</a></li><li><a href="/documentation/the-sling-engine.html">The Sling Engine</a></li><li><a href="/documentation/development.html">Development</a></li><li><a href="/documentation/bundles.html">Bundles</a></li><li><a href="/documentation/tutorials-how-tos.html">Tutorials &amp; How-Tos</a></li><li><a href="/components/">Maven Plugins</a></li><li><a href="/documentation/configuration.html">Configuration</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>API Docs</strong>
                                    </p><ul>
                                        <li><a href="/apidocs/sling12/index.html">Sling 12</a></li><li><a href="/apidocs/sling11/index.html">Sling 11</a></li><li><a href="/apidocs/sling10/index.html">Sling 10</a></li><li><a href="/apidocs/sling9/index.html">Sling 9</a></li><li><a href="/documentation/apidocs.html">All versions</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Support</strong>
                                    </p><ul>
                                        <li><a href="https://s.apache.org/sling.wiki">Wiki</a></li><li><a href="https://s.apache.org/sling.faq">FAQ</a></li><li><a href="/sitemap.html">Sitemap</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Project Info</strong>
                                    </p><ul>
                                        <li><a href="/downloads.cgi">Downloads</a></li><li><a href="https://www.apache.org/licenses/">License</a></li><li><a href="/news.html">News</a></li><li><a href="/releases.html">Releases</a></li><li><a href="https://issues.apache.org/jira/browse/SLING">Issue Tracker</a></li><li><a href="/links.html">Links</a></li><li><a href="/contributing.html">Contributing</a></li><li><a href="/project-information.html">Project Information</a></li><li><a href="/project-information/security.html">Security</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Source</strong>
                                    </p><ul>
                                        <li><a href="/repolist.html">Repositories</a></li><li><a href="https://gitbox.apache.org/repos/asf?s=sling">Git at Apache</a></li>
                                    </ul>
                                </li><li>
                                    <p class="menu-label">
                                        <strong>Apache Software<br>Foundation</strong>
                                    </p><ul>
                                        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks!</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html">Become a Sponsor</a></li><li><a href="https://www.apache.org/foundation/buy_stuff.html">Buy Stuff</a></li>
                                    </ul>
                                </li><li>
                                    <a class="acevent" data-format="square" data-event="random"></a>
                                </li><li>
                                    <a href="https://apache.org/foundation/contributing.html" class="column">
                                        <img border="0" alt="Support the Apache Software Foundation!" src="/res/images/SupportApache-small.png" width="125"/>
                                    </a>
                                </li>
                            </ul>
                        </nav>
                    </div>                    
                </div><div class="column main">
                    <div class="box is-shadowless is-marginless">
                        <div class="level">
                            <div class="pagenav">
<div class="breadcrumb">
                                    <ul>
                                        <li>
                                            <a href="/">
                                                Home
                                            </a>
                                        </li><li>
                                            <a href="/documentation.html">
                                                Documentation
                                            </a>
                                        </li><li>
                                            <a href="/documentation/development.html">
                                                Development
                                            </a>
                                        </li>
                                    </ul>
                                </div>                                
                            </div><div class="tags">
                                <span class="tag">
                                    <a href="/tags/development.html">
                                        development
                                    </a>
                                </span><span class="tag">
                                    <a href="/tags/contentloading.html">
                                        contentloading
                                    </a>
                                </span>
                            </div>
                        </div><h1 class="title">
                            Content-Package based development
                        </h1><nav class="menu">
                            <ul class="menu-list box is-shadowless is-paddingless">
                                <li id="generatedToC">
                                    <p class="menu-label">
                                        <strong>Table of Contents</strong>
                                    </p>
                                </li>
                            </ul>
                        </nav><script src='/res/jquery-3.2.1.min.js' type='text/javascript'></script><script src='/res/tocjs-1-1-2.js' type='text/javascript'></script><script type='text/javascript'>$(document).ready(function() { $('#generatedToC').toc({'selector':'h1[class!=title],h2,h3','ulClass':'menu-list'}); } );</script><div class="content is-marginless">
<div class="row" data-pagefind-body="true"><div><section><h1><a href="#content-package-based-development" id="content-package-based-development">Content-Package based development</a></h1>
<p>Sling offers first-class support for <a href="https://jackrabbit.apache.org/filevault/">Apache Jackrabbit FileVault</a> content packages. FileVault offers a way of mapping content on filesystem to the JCR repository and the other way around. Content packages are an alternative to <a href="/documentation/bundles/content-loading-jcr-contentloader.html">the content loader mechanism</a>, offering a richer tool set and better support for deploying additional entities, such as users, groups, and access control entries.</p>
<p>There are three components of the content packages support:</p>
<ul>
<li>client-side tooling for building and installing content packages</li>
<li>server-side support for installing content packages at runtime</li>
<li>server-side support for installing content packages at build time</li>
</ul>
<p>The server-side support for Apache Sling is made of:</p>
<ul>
<li>the <a href="https://www.composum.com/home/nodes/pckgmgr.html">Composum Package Manager</a>, implementing the HTTP API that receives and installs content packages</li>
<li>the <a href="/documentation/bundles/content-package-installer-factory.html">Apache Sling Content Package Installer Factory</a>, allowing the deployment of content packages at build time.</li>
</ul>
<p>Content packages can be included at build time using either the <a href="/documentation/development/slingstart.html">provisioning model</a> or the <a href="/documentation/development/feature-model.html">feature model</a>.</p>
<p>The client-side support depends on the toolset used to build the project.</p>
<p>For Maven projects, this support consists of</p>
<ul>
<li>the <a href="https://jackrabbit.apache.org/filevault-package-maven-plugin/">filevault-package-maven-plugin</a> builds content packages from Maven projects</li>
<li>the <a href="https://wcm.io/tooling/maven/plugins/wcmio-content-package-maven-plugin/">wcmio-content-package-maven-plugin</a> uploads content packages at runtime to a Sling instance using an HTTP API</li>
</ul>
<p>For Javascript projects, the suport consists of the <a href="https://github.com/apache/sling-slingpackager/">Sling Packager</a>.</p>
<h2><a href="#creating-a-content-package" id="creating-a-content-package">Creating a content package</a></h2>
<h3><a href="#maven-projects" id="maven-projects">Maven projects</a></h3>
<p>There are two options for getting started with content package projects via Maven.</p>
<p>The first one is the <a href="https://github.com/apache/sling-project-archetype">Sling Project Archetype</a>, which creates a multi-module project that includes content packages as part of its output. To use it, run the following command</p>
<pre><code>$ mvn archetype:generate -Dfilter=org.apache.sling:sling-project-archetype
</code></pre>
<p>then select the latest version of the archetype and fill in the required information.</p>
<p>The second one is <a href="https://github.com/apache/sling-content-package-archetype">Content-Package Archetype</a> , which creates a single content package. Similar to the <code>sling-project-archetype</code>, generating a project only requires:</p>
<pre><code>$ mvn archetype:generate -Dfilter=org.apache.sling:sling-content-archetype
</code></pre>
<p>Using one archetype or the other is largely a matter of preference. The <code>sling-project-archetype</code> takes a more batteries-included approach, while the <code>sling-content-archetype</code> creates only a minimal content package.</p>
<h3><a href="#node-projects" id="node-projects">Node projects</a></h3>
<p>An example project using the Sling Packager can be found at <a href="https://github.com/peregrine-cms/simple-sling-vue-example">peregrine-cms/simple-sling-vue-example</a> on GitHub.</p>
<h2><a href="#deploying-a-content-package-at-runtime" id="deploying-a-content-package-at-runtime">Deploying a content package at runtime</a></h2>
<h3><a href="#maven-projects" id="maven-projects">Maven projects</a></h3>
<p>Building a content package is achieved using the Maven command line</p>
<pre><code>$ mvn package
</code></pre>
<p>After starting up Sling, the resulting file can then be deployed using the wcmio-content-package-maven-plugin</p>
<pre><code>$ mvn wcmio-content-package:install
</code></pre>
<h3><a href="#nodejs-projects" id="nodejs-projects">Node.js projects</a></h3>
<p>Content packages are built with</p>
<pre><code>$ npx slingpackager package &lt;folder&gt;
</code></pre>
<p>After starting up Sling, the resulting file can then be deployed with</p>
<pre><code>$ npx slingpackager upload &lt;content-package.zip&gt; -i
</code></pre>
<h3><a href="#composum-ui" id="composum-ui">Composum UI</a></h3>
<p>The <a href="https://www.composum.com/home/nodes/pckgmgr.html">Composum package manager</a> allows performing multiple operations through its user interface. To access the package manager, ensure that you are logged in to the Sling Starter and then navigate to the Composum Package Manager at <a href="http://localhost:8080/bin/packages.html">http://localhost:8080/bin/packages.html</a>.</p>
<p>Some of the possible operations are:</p>
<ul>
<li>building content packages from existing content</li>
<li>uploading and installing existing content packages</li>
<li>uninstalling existing content packages</li>
</ul>
<h3><a href="#osgi-installer" id="osgi-installer">OSGi Installer</a></h3>
<p>Installing packages through the <a href="../bundles/osgi-installer.html">OSGi installer</a> is supported via the <a href="../bundles/content-package-installer-factory.html">Content Package Installer Factory</a>.</p>
<h3><a href="#notes" id="notes">Notes</a></h3>
<p>Inspecting the content package reveals that is is just a ZIP file with additional metadata. Of definite interest are the manifest - <code>META-INF/MANIFEST.MF</code> and the filter definition - <code>META-INF/vault/filter.xml</code>. More information can be found at <a href="https://jackrabbit.apache.org/filevault/metadata.html">https://jackrabbit.apache.org/filevault/metadata.html</a>.</p>
<p>The <a href="/documentation/development/ide-tooling.html">Sling IDE Tooling</a> has support for exporting and importing content incrementally to a Sling instance, and can be used alongside the Maven-based tooling.</p>
<h2><a href="#installing-a-content-package-at-build-time" id="installing-a-content-package-at-build-time">Installing a content package at build time</a></h2>
<p>For the content package to be installed at build time, it must be available in a Maven repository at the time when the Sling application is built.</p>
<p>For the provisioning model, the content package must be added to an <code>artifacts</code> section, with the zip extension.</p>
<pre><code>[feature name=my-app]

[artifacts]
  org.apache.sling.sample/org.apache.sling.sample001/1.0-SNAPSHOT/zip
</code></pre>
<p>For the feature model, the content package must be added to the <code>content-packages</code> section, also with a zip extension:</p>
<pre><code>{
  &quot;id&quot;: &quot;...&quot;,
  &quot;content-packages:ARTIFACTS|true&quot;: [
    &quot;org.apache.sling.sample:org.apache.sling.sample001:zip:1.0-SNAPSHOT&quot;
  ]
}
</code></pre>
</section></div></div><div data-pagefind-body="true" data-pagefind-weight="7.0" style="display:none;"> - ( Content-Package based development )</div>                            
                        </div>
                    </div>
                </div>
            </div><footer class="footer">
                <div class="content has-text-centered is-small">
<div class="editpagelink">
                        This page can be edited on GitHub at <a href="https://github.com/apache/sling-site/edit/master/src/main/jbake/content/documentation/development/content-packages.md">
                            content/documentation/development/content-packages.md
                        </a>
                    </div>                    <div class="revisionInfo">
                        Last modified by <span class="author">Konrad Windszus</span> on <span class="comment">2022-03-08</span>
                    </div><p>
                        Apache Sling, Sling, Apache, the Apache feather logo, and the Apache Sling project
    logo are trademarks of The Apache Software Foundation. All other marks mentioned 
    may be trademarks or registered trademarks of their respective owners.
                    </p><p>
                        Copyright © 2007-2024<a href="https://www.apache.org/">
                            The Apache Software Foundation
                        </a>|<a href="https://privacy.apache.org/policies/privacy-policy-public.html">
                            Privacy Policy
                        </a>
                    </p>
                </div>
            </footer>
        </div>
    </body>
</html>